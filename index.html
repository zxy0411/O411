<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>星际单词播放器 - 蓝紫色科技星辰主题</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&family=Exo+2:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-dark: #0a0a1a;
            --primary-blue: #1a1a3a;
            --primary-purple: #4a1a6a;
            --accent-blue: #3a6bc9;
            --accent-purple: #8a2be2;
            --accent-pink: #d44b9d;
            --text-primary: #e0e0ff;
            --text-secondary: #b0b0d0;
            --glass-bg: rgba(26, 26, 58, 0.7);
            --glass-border: rgba(138, 43, 226, 0.3);
            --glow: 0 0 15px rgba(138, 43, 226, 0.7);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        body {
            font-family: 'Exo 2', sans-serif;
            background-color: var(--primary-dark);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(58, 107, 201, 0.15) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(138, 43, 226, 0.15) 0%, transparent 20%),
                radial-gradient(circle at 50% 50%, rgba(212, 75, 157, 0.1) 0%, transparent 30%);
        }

        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .star {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            animation: twinkle 3s infinite alternate;
        }

        @keyframes twinkle {
            0% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            position: relative;
        }

        h1 {
            font-family: 'Orbitron', sans-serif;
            font-size: 3.2rem;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple), var(--accent-pink));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 15px rgba(138, 43, 226, 0.5);
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.2rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .card {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--glow);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(138, 43, 226, 0.4);
        }

        .section-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--accent-blue);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--accent-purple);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .input-section, .control-section {
            display: flex;
            flex-direction: column;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            background: rgba(10, 10, 26, 0.7);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 15px;
            font-size: 1.1rem;
            color: var(--text-primary);
            resize: vertical;
            font-family: 'Exo 2', sans-serif;
            line-height: 1.5;
            margin-bottom: 15px;
        }

        textarea:focus {
            outline: none;
            border-color: var(--accent-purple);
            box-shadow: 0 0 10px rgba(138, 43, 226, 0.5);
        }

        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-family: 'Exo 2', sans-serif;
            font-weight: 500;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple));
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(90deg, var(--accent-purple), var(--accent-blue));
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(138, 43, 226, 0.4);
        }

        .btn-secondary {
            background: rgba(58, 107, 201, 0.2);
            color: var(--text-primary);
            border: 1px solid var(--accent-blue);
        }

        .btn-secondary:hover {
            background: rgba(58, 107, 201, 0.4);
            transform: translateY(-3px);
        }

        .btn-play {
            background: linear-gradient(90deg, var(--success), #0da271);
            color: white;
        }

        .btn-play:hover {
            background: linear-gradient(90deg, #0da271, var(--success));
            transform: translateY(-3px);
        }

        .btn-pause {
            background: linear-gradient(90deg, var(--warning), #d97706);
            color: white;
        }

        .btn-pause:hover {
            background: linear-gradient(90deg, #d97706, var(--warning));
            transform: translateY(-3px);
        }

        .btn-stop {
            background: linear-gradient(90deg, var(--error), #dc2626);
            color: white;
        }

        .btn-stop:hover {
            background: linear-gradient(90deg, #dc2626, var(--error));
            transform: translateY(-3px);
        }

        .control-group {
            margin-bottom: 25px;
        }

        .control-row {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .control-label {
            width: 150px;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .control-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            flex: 1;
        }

        .option-btn {
            padding: 8px 15px;
            background-color: rgba(26, 26, 58, 0.5);
            border: 1px solid var(--glass-border);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--text-secondary);
        }

        .option-btn:hover {
            background-color: rgba(58, 107, 201, 0.2);
            color: var(--text-primary);
        }

        .option-btn.active {
            background-color: var(--accent-purple);
            color: white;
            border-color: var(--accent-purple);
        }

        .slider-container {
            display: flex;
            align-items: center;
            flex: 1;
        }

        input[type="range"] {
            flex: 1;
            height: 8px;
            -webkit-appearance: none;
            background: rgba(138, 43, 226, 0.3);
            border-radius: 4px;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-purple);
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent-purple);
            cursor: pointer;
            border: none;
        }

        .slider-value {
            width: 50px;
            text-align: right;
            font-weight: 600;
            color: var(--accent-blue);
        }

        .word-display-section {
            margin-bottom: 30px;
        }

        .current-word {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 350px;
            padding: 40px 30px;
            text-align: center;
        }

        .word-text {
            font-family: 'Exo 2', sans-serif;
            font-size: 4.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: white;
            text-shadow: 0 0 20px rgba(138, 43, 226, 0.8);
            letter-spacing: 2px;
        }

        .phonetic {
            font-size: 1.5rem;
            color: var(--accent-pink);
            font-style: italic;
            margin-bottom: 15px;
            font-family: monospace;
        }

        .pos-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .pos {
            display: inline-block;
            background: rgba(138, 43, 226, 0.2);
            color: var(--accent-purple);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 1.2rem;
            border: 1px solid var(--accent-purple);
        }

        .definition {
            max-width: 800px;
            margin: 0 auto;
        }

        .definition-en {
            font-size: 1.4rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 15px;
            font-style: italic;
        }

        .definition-cn {
            font-size: 1.8rem;
            color: white;
            font-weight: 500;
            margin-bottom: 30px;
        }

        .audio-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .progress-info {
            text-align: center;
            margin-top: 20px;
            color: var(--text-secondary);
            font-size: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-ready {
            background-color: var(--success);
            box-shadow: 0 0 10px var(--success);
        }

        .status-playing {
            background-color: var(--warning);
            box-shadow: 0 0 10px var(--warning);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .word-list-container {
            max-height: 300px;
            overflow-y: auto;
            border-radius: 12px;
            border: 1px solid var(--glass-border);
            background: rgba(10, 10, 26, 0.5);
        }

        .word-list {
            list-style-type: none;
        }

        .word-item {
            padding: 15px 20px;
            border-bottom: 1px solid rgba(138, 43, 226, 0.2);
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: all 0.3s;
            cursor: pointer;
        }

        .word-item:hover {
            background-color: rgba(58, 107, 201, 0.2);
        }

        .word-item.current {
            background-color: rgba(138, 43, 226, 0.2);
            border-left: 4px solid var(--accent-purple);
        }

        .word-item-text {
            font-weight: 500;
            font-size: 1.2rem;
        }

        .word-item-pos {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-left: 10px;
        }

        .word-item-audio {
            color: var(--text-secondary);
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            border-top: 1px solid rgba(138, 43, 226, 0.2);
        }

        .highlight {
            color: var(--accent-purple);
            font-weight: 500;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(26, 26, 58, 0.9);
            border: 1px solid var(--accent-purple);
            border-radius: 10px;
            padding: 15px 20px;
            color: white;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 10px;
            transform: translateX(150%);
            transition: transform 0.3s ease;
            max-width: 400px;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.info {
            border-left: 4px solid var(--accent-blue);
        }

        .notification.warning {
            border-left: 4px solid var(--warning);
        }

        .notification.error {
            border-left: 4px solid var(--error);
        }

        .notification.success {
            border-left: 4px solid var(--success);
        }

        .api-info {
            background-color: rgba(3, 105, 161, 0.1);
            border: 1px solid rgba(3, 105, 161, 0.3);
            border-radius: 8px;
            padding: 12px 15px;
            margin-top: 15px;
            font-size: 0.9rem;
            color: var(--accent-blue);
        }

        .audio-status {
            font-size: 1rem;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .audio-available {
            color: var(--success);
        }

        .audio-missing {
            color: var(--warning);
        }

        .tts-controls {
            margin-top: 15px;
            padding: 15px;
            background-color: rgba(14, 165, 233, 0.1);
            border-radius: 10px;
            border-left: 4px solid var(--accent-blue);
        }

        .tts-info {
            font-size: 0.9rem;
            color: var(--accent-blue);
            margin-bottom: 10px;
        }

        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2.5rem;
            }
            
            .word-text {
                font-size: 3.5rem;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .notification {
                left: 20px;
                right: 20px;
                transform: translateY(-150%);
            }
            
            .notification.show {
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <!-- 星空背景 -->
    <div class="stars" id="stars"></div>

    <!-- 通知区域 -->
    <div id="notification" class="notification">
        <i class="fas fa-info-circle"></i>
        <span id="notification-text">通知内容</span>
    </div>

    <div class="container">
        <header>
            <h1><i class="fas fa-satellite"></i> 星际单词播放器</h1>
            <p class="subtitle">输入单词，自动查询词性、双语释义，并同步播放音频</p>
        </header>

        <div class="main-content">
            <!-- 输入区域 -->
            <section class="card input-section">
                <h2 class="section-title"><i class="fas fa-keyboard"></i> 输入单词列表</h2>
                <p style="margin-bottom: 15px; color: var(--text-secondary);">每行输入一个单词，或使用示例单词</p>
                <textarea id="wordInput" placeholder="每行输入一个单词，例如：&#10;hello&#10;world&#10;programming&#10;computer&#10;science">hello
world
programming
computer
science
technology
development
application
interface
algorithm</textarea>
                
                <div class="api-info">
                    <i class="fas fa-info-circle"></i> 使用免费在线词典API，部分单词可能无法获取音频或翻译。单词释义会自动翻译为中文。
                </div>
                
                <div class="button-group">
                    <button class="btn btn-primary" id="loadExample">
                        <i class="fas fa-magic"></i> 加载示例单词
                    </button>
                    <button class="btn btn-primary" id="queryWords">
                        <i class="fas fa-search"></i> 查询单词信息
                    </button>
                    <button class="btn btn-secondary" id="clearWords">
                        <i class="fas fa-trash-alt"></i> 清空列表
                    </button>
                </div>
            </section>

            <!-- 控制区域 -->
            <section class="card control-section">
                <h2 class="section-title"><i class="fas fa-sliders-h"></i> 播放控制</h2>
                
                <div class="control-group">
                    <div class="control-row">
                        <div class="control-label">发音选择:</div>
                        <div class="control-options" id="pronunciationOptions">
                            <div class="option-btn active" data-value="uk">英音</div>
                            <div class="option-btn" data-value="us">美音</div>
                            <div class="option-btn" data-value="both">英音+美音</div>
                        </div>
                    </div>
                    
                    <div class="control-row">
                        <div class="control-label">播放速度:</div>
                        <div class="control-options" id="speedOptions">
                            <div class="option-btn" data-value="0.5">0.5x</div>
                            <div class="option-btn" data-value="0.75">0.75x</div>
                            <div class="option-btn active" data-value="1">1x</div>
                            <div class="option-btn" data-value="1.25">1.25x</div>
                            <div class="option-btn" data-value="1.5">1.5x</div>
                            <div class="option-btn" data-value="2">2x</div>
                            <div class="option-btn" data-value="2.5">2.5x</div>
                            <div class="option-btn" data-value="3">3x</div>
                        </div>
                    </div>
                    
                    <div class="control-row">
                        <div class="control-label">重复次数:</div>
                        <div class="slider-container">
                            <input type="range" id="repeatCount" min="1" max="10" value="1" step="1">
                            <span class="slider-value" id="repeatValue">1 次</span>
                        </div>
                    </div>
                    
                    <div class="control-row">
                        <div class="control-label">间隔时间:</div>
                        <div class="slider-container">
                            <input type="range" id="intervalTime" min="1" max="50" value="5" step="1">
                            <span class="slider-value" id="intervalValue">0.5 秒</span>
                        </div>
                    </div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-play" id="playBtn">
                        <i class="fas fa-play"></i> 开始播放
                    </button>
                    <button class="btn btn-pause" id="pauseBtn" disabled>
                        <i class="fas fa-pause"></i> 暂停
                    </button>
                    <button class="btn btn-stop" id="stopBtn" disabled>
                        <i class="fas fa-stop"></i> 停止
                    </button>
                </div>
                
                <div class="progress-info">
                    <div class="status-indicator">
                        <span class="status-dot status-ready" id="statusIndicator"></span>
                        <span id="statusText">准备就绪</span>
                    </div>
                    <div id="progressText"></div>
                </div>
            </section>
        </div>

        <!-- 单词显示区域 -->
        <section class="card word-display-section">
            <h2 class="section-title"><i class="fas fa-volume-up"></i> 当前单词</h2>
            <div class="current-word">
                <div class="word-text" id="currentWord">-</div>
                <div class="phonetic" id="currentPhonetic">-</div>
                <div class="pos-container" id="currentPos"></div>
                <div class="definition">
                    <div class="definition-en" id="currentDefinitionEn">-</div>
                    <div class="definition-cn" id="currentDefinitionCn">-</div>
                </div>
                
                <div class="audio-status" id="audioStatus">
                    <i class="fas fa-volume-up"></i> <span>音频状态: 未知</span>
                </div>
                
                <div class="audio-controls">
                    <button class="btn btn-secondary" id="playCurrentBtn" disabled>
                        <i class="fas fa-play-circle"></i> 播放当前单词
                    </button>
                    <button class="btn btn-secondary" id="playUkBtn" disabled>
                        <i class="fas fa-volume-up"></i> 播放英音
                    </button>
                    <button class="btn btn-secondary" id="playUsBtn" disabled>
                        <i class="fas fa-volume-up"></i> 播放美音
                    </button>
                </div>
                
                <div class="tts-controls" id="ttsControls" style="display: none;">
                    <div class="tts-info">
                        <i class="fas fa-info-circle"></i> 该单词无API音频，已启用浏览器语音合成(TTS)作为备用
                    </div>
                    <button class="btn btn-secondary" id="playTTSBtn">
                        <i class="fas fa-robot"></i> 使用TTS播放
                    </button>
                </div>
            </div>
        </section>

        <!-- 单词列表区域 -->
        <section class="card">
            <h2 class="section-title"><i class="fas fa-list"></i> 单词列表</h2>
            <div class="word-list-container">
                <ul class="word-list" id="wordList">
                    <!-- 单词列表将在这里动态生成 -->
                    <li class="word-item current">
                        <div>
                            <span class="word-item-text">Welcome</span>
                            <span class="word-item-pos"> | n.</span>
                        </div>
                        <div class="word-item-audio">
                            <i class="fas fa-volume-up" style="color:#10b981;"></i>
                        </div>
                    </li>
                </ul>
            </div>
        </section>

        <footer>
            <p>星际单词播放器 &copy; 2023 | 支持英音/美音切换 | 播放速度 0.5x - 3x | 间隔时间 0.1秒起</p>
            <p style="margin-top: 5px; font-size: 0.8rem;">提示: 使用在线词典API查询单词，英文释义自动翻译为中文。无API音频时使用浏览器TTS。</p>
        </footer>
    </div>

    <script>
        // 创建星空背景
        function createStars() {
            const starsContainer = document.getElementById('stars');
            const starCount = 150;
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                star.classList.add('star');
                
                // 随机大小和位置
                const size = Math.random() * 3;
                const posX = Math.random() * 100;
                const posY = Math.random() * 100;
                const delay = Math.random() * 3;
                
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.left = `${posX}%`;
                star.style.top = `${posY}%`;
                star.style.animationDelay = `${delay}s`;
                
                starsContainer.appendChild(star);
            }
        }

        // 通知系统
        class NotificationSystem {
            constructor() {
                this.notification = document.getElementById('notification');
                this.notificationText = document.getElementById('notification-text');
                this.hideTimeout = null;
            }
            
            show(message, type = 'info', duration = 3000) {
                // 清除之前的超时
                if (this.hideTimeout) {
                    clearTimeout(this.hideTimeout);
                }
                
                // 更新通知内容和样式
                this.notificationText.textContent = message;
                this.notification.className = `notification ${type}`;
                
                // 显示通知
                setTimeout(() => {
                    this.notification.classList.add('show');
                }, 10);
                
                // 自动隐藏
                this.hideTimeout = setTimeout(() => {
                    this.hide();
                }, duration);
            }
            
            hide() {
                this.notification.classList.remove('show');
            }
        }

        // 单词播放器类
        class WordPlayer {
            constructor() {
                this.words = [];
                this.currentIndex = 0;
                this.isPlaying = false;
                this.isPaused = false;
                this.currentAudio = null;
                this.repeatCount = 1;
                this.intervalTime = 0.5;
                this.pronunciation = 'uk'; // 'uk', 'us', 'both'
                this.playbackRate = 1.0;
                this.dictionaryApiUrl = 'https://api.dictionaryapi.dev/api/v2/entries/en/';
                this.translationApiUrl = 'https://api.mymemory.translated.net/get';
                this.notification = new NotificationSystem();
                
                this.initElements();
                this.initEventListeners();
                this.loadVoices();
                
                // 初始状态
                this.updateStatus('ready', '准备就绪，点击"查询单词信息"开始');
            }
            
            initElements() {
                // 输入区域
                this.wordInput = document.getElementById('wordInput');
                this.loadExampleBtn = document.getElementById('loadExample');
                this.queryWordsBtn = document.getElementById('queryWords');
                this.clearWordsBtn = document.getElementById('clearWords');
                
                // 控制区域
                this.playBtn = document.getElementById('playBtn');
                this.pauseBtn = document.getElementById('pauseBtn');
                this.stopBtn = document.getElementById('stopBtn');
                
                // 单词显示区域
                this.currentWordEl = document.getElementById('currentWord');
                this.currentPhoneticEl = document.getElementById('currentPhonetic');
                this.currentPosEl = document.getElementById('currentPos');
                this.currentDefinitionEnEl = document.getElementById('currentDefinitionEn');
                this.currentDefinitionCnEl = document.getElementById('currentDefinitionCn');
                this.audioStatusEl = document.getElementById('audioStatus');
                this.ttsControlsEl = document.getElementById('ttsControls');
                this.playTTSBtn = document.getElementById('playTTSBtn');
                
                // 音频控制按钮
                this.playCurrentBtn = document.getElementById('playCurrentBtn');
                this.playUkBtn = document.getElementById('playUkBtn');
                this.playUsBtn = document.getElementById('playUsBtn');
                
                // 状态显示
                this.statusIndicator = document.getElementById('statusIndicator');
                this.statusText = document.getElementById('statusText');
                this.progressText = document.getElementById('progressText');
                
                // 单词列表
                this.wordList = document.getElementById('wordList');
                
                // 控制选项
                this.pronunciationOptions = document.querySelectorAll('#pronunciationOptions .option-btn');
                this.speedOptions = document.querySelectorAll('#speedOptions .option-btn');
                this.repeatCountSlider = document.getElementById('repeatCount');
                this.repeatValue = document.getElementById('repeatValue');
                this.intervalTimeSlider = document.getElementById('intervalTime');
                this.intervalValue = document.getElementById('intervalValue');
                
                // 示例单词
                this.exampleWords = [
                    "hello", "world", "programming", "computer", "science", 
                    "technology", "development", "application", "interface", "algorithm"
                ];
            }
            
            initEventListeners() {
                // 输入区域按钮
                this.loadExampleBtn.addEventListener('click', () => this.loadExampleWords());
                this.queryWordsBtn.addEventListener('click', () => this.queryAllWords());
                this.clearWordsBtn.addEventListener('click', () => this.clearWordList());
                
                // 播放控制按钮
                this.playBtn.addEventListener('click', () => this.startPlayback());
                this.pauseBtn.addEventListener('click', () => this.togglePause());
                this.stopBtn.addEventListener('click', () => this.stopPlayback());
                
                // 音频控制按钮
                this.playCurrentBtn.addEventListener('click', () => this.playCurrentWord());
                this.playUkBtn.addEventListener('click', () => this.playPronunciation('uk'));
                this.playUsBtn.addEventListener('click', () => this.playPronunciation('us'));
                this.playTTSBtn.addEventListener('click', () => this.playWithTTS());
                
                // 发音选项
                this.pronunciationOptions.forEach(option => {
                    option.addEventListener('click', () => {
                        this.pronunciationOptions.forEach(opt => opt.classList.remove('active'));
                        option.classList.add('active');
                        this.pronunciation = option.dataset.value;
                    });
                });
                
                // 速度选项
                this.speedOptions.forEach(option => {
                    option.addEventListener('click', () => {
                        this.speedOptions.forEach(opt => opt.classList.remove('active'));
                        option.classList.add('active');
                        this.playbackRate = parseFloat(option.dataset.value);
                    });
                });
                
                // 重复次数滑块
                this.repeatCountSlider.addEventListener('input', () => {
                    const value = this.repeatCountSlider.value;
                    this.repeatValue.textContent = `${value} 次`;
                    this.repeatCount = parseInt(value);
                });
                
                // 间隔时间滑块
                this.intervalTimeSlider.addEventListener('input', () => {
                    const value = parseFloat(this.intervalTimeSlider.value / 10).toFixed(1);
                    this.intervalValue.textContent = `${value} 秒`;
                    this.intervalTime = parseFloat(value);
                });
            }
            
            // 加载语音
            loadVoices() {
                // 获取可用语音
                this.speechVoices = speechSynthesis.getVoices();
                
                // 如果还没有加载完成，等待加载
                if (this.speechVoices.length === 0) {
                    speechSynthesis.onvoiceschanged = () => {
                        this.speechVoices = speechSynthesis.getVoices();
                        console.log(`加载了 ${this.speechVoices.length} 种语音`);
                    };
                } else {
                    console.log(`加载了 ${this.speechVoices.length} 种语音`);
                }
            }
            
            // 加载示例单词
            loadExampleWords() {
                this.wordInput.value = this.exampleWords.join('\n');
                this.notification.show('示例单词已加载', 'info');
            }
            
            // 清空单词列表
            clearWordList() {
                this.words = [];
                this.currentIndex = 0;
                this.updateWordList();
                this.updateCurrentWordDisplay();
                this.updateStatus('ready', '列表已清空');
                this.disablePlaybackControls();
                this.notification.show('单词列表已清空', 'info');
            }
            
            // 查询所有单词
            async queryAllWords() {
                const wordText = this.wordInput.value.trim();
                if (!wordText) {
                    this.notification.show('请输入至少一个单词', 'warning');
                    return;
                }
                
                const words = wordText.split('\n')
                    .map(w => w.trim())
                    .filter(w => w.length > 0);
                
                if (words.length === 0) {
                    this.notification.show('请输入有效的单词', 'warning');
                    return;
                }
                
                // 重置状态
                this.words = [];
                this.currentIndex = 0;
                this.updateWordList();
                this.updateCurrentWordDisplay();
                
                // 显示加载状态
                this.updateStatus('loading', `正在查询 ${words.length} 个单词...`);
                this.queryWordsBtn.disabled = true;
                this.queryWordsBtn.innerHTML = '<span class="loading"></span> 查询中...';
                
                try {
                    // 查询每个单词
                    for (let i = 0; i < words.length; i++) {
                        const word = words[i];
                        this.progressText.textContent = `查询进度: ${i+1}/${words.length}`;
                        
                        try {
                            // 查询单词基本信息
                            const wordData = await this.queryWord(word);
                            
                            // 显示单词信息（英文释义）
                            this.words.push(wordData);
                            this.updateWordList();
                            
                            // 如果这是第一个单词，更新显示
                            if (i === 0) {
                                this.currentIndex = 0;
                                this.updateCurrentWordDisplay();
                            }
                            
                            // 尝试翻译释义为中文
                            if (wordData.definition) {
                                try {
                                    const translation = await this.translateText(wordData.definition);
                                    wordData.definition_cn = translation;
                                    
                                    // 更新显示
                                    if (this.currentIndex === i) {
                                        this.updateCurrentWordDisplay();
                                    }
                                } catch (translationError) {
                                    console.error(`翻译单词 "${word}" 失败:`, translationError);
                                    wordData.definition_cn = "翻译失败，请稍后重试";
                                }
                            }
                        } catch (error) {
                            console.error(`查询单词 "${word}" 失败:`, error);
                            this.words.push({
                                word: word,
                                phonetic: 'N/A',
                                definition: '无法查询到该单词的释义',
                                definition_cn: '无法查询到该单词的释义',
                                meanings: [],
                                phonetics: [],
                                ukAudio: null,
                                usAudio: null,
                                hasAudio: false
                            });
                            this.updateWordList();
                        }
                        
                        // 防止请求过快（避免触发API限制）
                        await this.sleep(500);
                    }
                    
                    this.updateStatus('ready', `成功查询 ${this.words.length} 个单词`);
                    if (this.words.length > 0) {
                        this.enablePlaybackControls();
                        this.currentIndex = 0;
                        this.updateCurrentWordDisplay();
                    }
                    this.notification.show(`成功查询 ${this.words.length} 个单词`, 'success');
                } catch (error) {
                    this.notification.show('查询单词时发生错误，请稍后重试', 'error');
                    this.updateStatus('error', '查询失败');
                } finally {
                    this.queryWordsBtn.disabled = false;
                    this.queryWordsBtn.innerHTML = '<i class="fas fa-search"></i> 查询单词信息';
                    this.progressText.textContent = '';
                }
            }
            
            // 查询单个单词
            async queryWord(word) {
                try {
                    const response = await fetch(`${this.dictionaryApiUrl}${encodeURIComponent(word.toLowerCase())}`);
                    
                    if (!response.ok) {
                        throw new Error(`API请求失败: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    // 提取单词信息
                    const wordData = {
                        word: word,
                        phonetic: data[0]?.phonetic || 'N/A',
                        meanings: data[0]?.meanings || [],
                        phonetics: data[0]?.phonetics || [],
                        hasAudio: false
                    };
                    
                    // 改进的音频提取逻辑
                    let ukAudio = null;
                    let usAudio = null;
                    let anyAudio = null;
                    
                    // 首先收集所有音频URL
                    for (const phonetic of wordData.phonetics) {
                        if (phonetic.audio && phonetic.audio.trim() !== '') {
                            anyAudio = phonetic.audio;
                            
                            // 检查是否是英音或美音
                            if (phonetic.audio.includes('-gb.') || phonetic.audio.includes('-uk.')) {
                                ukAudio = phonetic.audio;
                            } else if (phonetic.audio.includes('-us.') || phonetic.audio.includes('-usa.')) {
                                usAudio = phonetic.audio;
                            }
                        }
                    }
                    
                    // 如果没有明确标记的音频，但有音频，尝试确定类型
                    if (!ukAudio && !usAudio && anyAudio) {
                        // 检查是否为英式英语词典
                        if (anyAudio.includes('oxford') || anyAudio.includes('gb') || anyAudio.includes('uk')) {
                            ukAudio = anyAudio;
                        } else {
                            // 默认分配为美音
                            usAudio = anyAudio;
                        }
                    }
                    
                    // 确保至少有一种音频
                    wordData.ukAudio = ukAudio || anyAudio;
                    wordData.usAudio = usAudio || anyAudio;
                    wordData.hasAudio = !!(wordData.ukAudio || wordData.usAudio);
                    
                    // 提取第一个释义的英文定义
                    if (wordData.meanings.length > 0 && wordData.meanings[0].definitions.length > 0) {
                        wordData.definition = wordData.meanings[0].definitions[0].definition;
                        wordData.partOfSpeech = wordData.meanings[0].partOfSpeech;
                    } else {
                        wordData.definition = "No definition found";
                        wordData.partOfSpeech = "Unknown";
                    }
                    
                    return wordData;
                } catch (error) {
                    console.error(`查询单词 "${word}" 失败:`, error);
                    throw error;
                }
            }
            
            // 翻译文本为中文
            async translateText(text) {
                // 如果文本太长，截取前200个字符
                const textToTranslate = text.length > 200 ? text.substring(0, 200) + "..." : text;
                
                try {
                    const response = await fetch(
                        `${this.translationApiUrl}?q=${encodeURIComponent(textToTranslate)}&langpair=en|zh-CN`
                    );
                    
                    if (!response.ok) {
                        throw new Error(`翻译API请求失败: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    if (data.responseData && data.responseData.translatedText) {
                        return data.responseData.translatedText;
                    } else {
                        throw new Error('翻译API返回无效数据');
                    }
                } catch (error) {
                    console.error('翻译失败:', error);
                    throw error;
                }
            }
            
            // 更新单词列表显示
            updateWordList() {
                this.wordList.innerHTML = '';
                
                this.words.forEach((wordData, index) => {
                    const li = document.createElement('li');
                    li.className = `word-item ${index === this.currentIndex ? 'current' : ''}`;
                    
                    const partOfSpeech = wordData.partOfSpeech || '未知';
                    const audioIcon = wordData.hasAudio ? 
                        '<i class="fas fa-volume-up" style="color:#10b981;"></i>' : 
                        '<i class="fas fa-volume-mute" style="color:#ef4444;"></i>';
                    
                    li.innerHTML = `
                        <div>
                            <span class="word-item-text">${wordData.word}</span>
                            <span class="word-item-pos"> | ${partOfSpeech}</span>
                        </div>
                        <div class="word-item-audio">
                            ${audioIcon}
                        </div>
                    `;
                    
                    li.addEventListener('click', () => {
                        this.currentIndex = index;
                        this.updateCurrentWordDisplay();
                        this.updateWordList();
                    });
                    
                    this.wordList.appendChild(li);
                });
            }
            
            // 更新当前单词显示
            updateCurrentWordDisplay() {
                if (this.words.length === 0 || this.currentIndex >= this.words.length) {
                    this.currentWordEl.textContent = '-';
                    this.currentPhoneticEl.textContent = '-';
                    this.currentPosEl.innerHTML = '';
                    this.currentDefinitionEnEl.textContent = '-';
                    this.currentDefinitionCnEl.textContent = '-';
                    this.playCurrentBtn.disabled = true;
                    this.playUkBtn.disabled = true;
                    this.playUsBtn.disabled = true;
                    this.audioStatusEl.innerHTML = '<i class="fas fa-volume-up"></i> <span>音频状态: 未知</span>';
                    this.ttsControlsEl.style.display = 'none';
                    return;
                }
                
                const wordData = this.words[this.currentIndex];
                
                this.currentWordEl.textContent = wordData.word;
                this.currentPhoneticEl.textContent = wordData.phonetic !== 'N/A' ? `/${wordData.phonetic}/` : '音标未找到';
                
                // 显示词性
                this.currentPosEl.innerHTML = '';
                if (wordData.meanings.length > 0) {
                    // 只显示前3个词性
                    wordData.meanings.slice(0, 3).forEach(meaning => {
                        const posSpan = document.createElement('span');
                        posSpan.className = 'pos';
                        posSpan.textContent = meaning.partOfSpeech;
                        this.currentPosEl.appendChild(posSpan);
                    });
                } else if (wordData.partOfSpeech) {
                    const posSpan = document.createElement('span');
                    posSpan.className = 'pos';
                    posSpan.textContent = wordData.partOfSpeech;
                    this.currentPosEl.appendChild(posSpan);
                }
                
                // 显示英文释义
                this.currentDefinitionEnEl.textContent = wordData.definition || '未找到释义';
                
                // 显示中文释义
                if (wordData.definition_cn) {
                    this.currentDefinitionCnEl.textContent = wordData.definition_cn;
                } else {
                    this.currentDefinitionCnEl.textContent = '翻译中...';
                }
                
                // 更新音频按钮状态和音频状态显示
                const hasUkAudio = wordData.ukAudio && wordData.ukAudio.trim() !== '';
                const hasUsAudio = wordData.usAudio && wordData.usAudio.trim() !== '';
                const hasAnyAudio = hasUkAudio || hasUsAudio;
                
                // 根据音频可用性更新按钮状态
                this.playCurrentBtn.disabled = !hasAnyAudio;
                this.playUkBtn.disabled = !hasUkAudio;
                this.playUsBtn.disabled = !hasUsAudio;
                
                // 更新音频状态显示
                if (hasUkAudio && hasUsAudio) {
                    this.audioStatusEl.innerHTML = '<i class="fas fa-volume-up" style="color:#10b981"></i> <span>音频状态: 英音和美音均可用</span>';
                    this.audioStatusEl.className = 'audio-status audio-available';
                    this.ttsControlsEl.style.display = 'none';
                } else if (hasAnyAudio) {
                    const availableType = hasUkAudio ? '英音' : '美音';
                    this.audioStatusEl.innerHTML = `<i class="fas fa-volume-up" style="color:#10b981"></i> <span>音频状态: ${availableType}可用</span>`;
                    this.audioStatusEl.className = 'audio-status audio-available';
                    this.ttsControlsEl.style.display = 'none';
                } else {
                    this.audioStatusEl.innerHTML = '<i class="fas fa-volume-mute" style="color:#ef4444"></i> <span>音频状态: 无API音频</span>';
                    this.audioStatusEl.className = 'audio-status audio-missing';
                    this.ttsControlsEl.style.display = 'block';
                }
                
                this.updateWordList();
            }
            
            // 使用TTS播放
            playWithTTS() {
                if (this.currentIndex >= this.words.length) return;
                
                const wordData = this.words[this.currentIndex];
                const word = wordData.word;
                
                // 检查浏览器是否支持语音合成
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(word);
                    
                    // 设置语速
                    utterance.rate = this.playbackRate;
                    
                    // 设置语言（尝试根据发音选择设置）
                    if (this.pronunciation === 'uk') {
                        utterance.lang = 'en-GB';
                    } else {
                        utterance.lang = 'en-US';
                    }
                    
                    // 播放前停止任何正在播放的语音
                    speechSynthesis.cancel();
                    
                    utterance.onstart = () => {
                        this.statusText.textContent = `TTS播放: ${word}`;
                    };
                    
                    utterance.onend = () => {
                        this.statusText.textContent = 'TTS播放完成';
                    };
                    
                    utterance.onerror = (event) => {
                        console.error('TTS播放错误:', event);
                        this.statusText.textContent = 'TTS播放失败';
                    };
                    
                    speechSynthesis.speak(utterance);
                } else {
                    this.notification.show('您的浏览器不支持语音合成(TTS)', 'warning');
                }
            }
            
            // 开始播放
            async startPlayback() {
                if (this.words.length === 0) {
                    this.notification.show('没有可播放的单词，请先查询单词', 'warning');
                    return;
                }
                
                this.isPlaying = true;
                this.isPaused = false;
                this.currentIndex = 0;
                
                this.updatePlaybackControls();
                this.updateStatus('playing', '正在播放...');
                
                await this.playWords();
            }
            
            // 播放单词序列
            async playWords() {
                while (this.currentIndex < this.words.length && this.isPlaying) {
                    if (this.isPaused) {
                        // 暂停状态，等待恢复
                        await this.sleep(100);
                        continue;
                    }
                    
                    const wordData = this.words[this.currentIndex];
                    
                    // 更新显示
                    this.updateCurrentWordDisplay();
                    this.progressText.textContent = `进度: ${this.currentIndex + 1}/${this.words.length}`;
                    
                    // 播放当前单词
                    for (let i = 0; i < this.repeatCount && this.isPlaying && !this.isPaused; i++) {
                        let audioPlayed = false;
                        
                        if (this.pronunciation === 'both') {
                            // 尝试播放英音
                            if (wordData.ukAudio) {
                                const ukResult = await this.playAudio(wordData.ukAudio, 'uk');
                                audioPlayed = audioPlayed || ukResult;
                                if (this.isPlaying && !this.isPaused && i < this.repeatCount - 1) {
                                    await this.sleep(this.intervalTime * 1000);
                                }
                            }
                            
                            // 尝试播放美音
                            if (wordData.usAudio && this.isPlaying && !this.isPaused) {
                                const usResult = await this.playAudio(wordData.usAudio, 'us');
                                audioPlayed = audioPlayed || usResult;
                                if (this.isPlaying && !this.isPaused && i < this.repeatCount - 1) {
                                    await this.sleep(this.intervalTime * 1000);
                                }
                            }
                            
                            // 如果两种音频都没有，尝试使用TTS
                            if (!audioPlayed && this.isPlaying && !this.isPaused) {
                                await this.playWordWithTTS(wordData.word);
                                if (this.isPlaying && !this.isPaused && i < this.repeatCount - 1) {
                                    await this.sleep(this.intervalTime * 1000);
                                }
                            }
                        } else {
                            // 播放选定的发音
                            const audioUrl = this.pronunciation === 'uk' ? wordData.ukAudio : wordData.usAudio;
                            if (audioUrl) {
                                const result = await this.playAudio(audioUrl, this.pronunciation);
                                audioPlayed = result;
                            }
                            
                            // 如果没有音频，尝试另一种发音
                            if (!audioPlayed) {
                                const alternativeUrl = this.pronunciation === 'uk' ? wordData.usAudio : wordData.ukAudio;
                                if (alternativeUrl) {
                                    const alternativeType = this.pronunciation === 'uk' ? 'us' : 'uk';
                                    const result = await this.playAudio(alternativeUrl, alternativeType);
                                    audioPlayed = result;
                                }
                            }
                            
                            // 如果仍然没有音频，使用TTS
                            if (!audioPlayed && this.isPlaying && !this.isPaused) {
                                await this.playWordWithTTS(wordData.word);
                            }
                            
                            // 重复间隔
                            if (audioPlayed && this.isPlaying && !this.isPaused && i < this.repeatCount - 1) {
                                await this.sleep(this.intervalTime * 1000);
                            }
                        }
                        
                        // 重复间隔（当音频播放失败时）
                        if (!audioPlayed && this.isPlaying && !this.isPaused && i < this.repeatCount - 1) {
                            await this.sleep(this.intervalTime * 1000);
                        }
                    }
                    
                    // 单词间间隔
                    if (this.isPlaying && !this.isPaused && this.currentIndex < this.words.length - 1) {
                        await this.sleep(this.intervalTime * 1000);
                    }
                    
                    this.currentIndex++;
                }
                
                // 播放完成或停止
                if (this.currentIndex >= this.words.length) {
                    this.updateStatus('ready', '播放完成');
                    this.isPlaying = false;
                    this.currentIndex = 0;
                    this.updatePlaybackControls();
                    this.progressText.textContent = '';
                    this.updateCurrentWordDisplay();
                    this.notification.show('所有单词播放完成', 'success');
                }
            }
            
            // 使用TTS播放单词
            playWordWithTTS(word) {
                return new Promise((resolve) => {
                    // 检查浏览器是否支持语音合成
                    if (!('speechSynthesis' in window)) {
                        this.statusText.textContent = `${word} 无音频且浏览器不支持TTS`;
                        resolve(false);
                        return;
                    }
                    
                    const utterance = new SpeechSynthesisUtterance(word);
                    
                    // 设置语速
                    utterance.rate = this.playbackRate;
                    
                    // 设置语言
                    utterance.lang = this.pronunciation === 'uk' ? 'en-GB' : 'en-US';
                    
                    // 播放前停止任何正在播放的语音
                    speechSynthesis.cancel();
                    
                    utterance.onstart = () => {
                        this.statusText.textContent = `TTS播放: ${word}`;
                    };
                    
                    utterance.onend = () => {
                        resolve(true);
                    };
                    
                    utterance.onerror = (event) => {
                        console.error('TTS播放错误:', event);
                        this.statusText.textContent = `${word} TTS播放失败`;
                        resolve(false);
                    };
                    
                    speechSynthesis.speak(utterance);
                });
            }
            
            // 播放音频
            playAudio(audioUrl, pronunciationType) {
                return new Promise((resolve) => {
                    if (!audioUrl || audioUrl.trim() === '') {
                        console.warn(`音频URL为空，跳过播放`);
                        resolve(false);
                        return;
                    }
                    
                    // 停止当前音频
                    if (this.currentAudio) {
                        this.currentAudio.pause();
                        this.currentAudio = null;
                    }
                    
                    // 创建新音频
                    const audio = new Audio();
                    audio.preload = 'auto';
                    audio.playbackRate = this.playbackRate;
                    
                    // 设置音频源
                    audio.src = audioUrl;
                    
                    // 更新状态显示
                    const pronunciationText = pronunciationType === 'uk' ? '英音' : '美音';
                    const word = this.words[this.currentIndex].word;
                    this.statusText.textContent = `正在播放: ${word} (${pronunciationText})`;
                    
                    // 设置超时，防止音频加载时间过长
                    const timeoutId = setTimeout(() => {
                        console.warn(`音频加载超时: ${audioUrl}`);
                        audio.pause();
                        resolve(false);
                    }, 5000);
                    
                    audio.addEventListener('loadeddata', () => {
                        clearTimeout(timeoutId);
                    });
                    
                    audio.addEventListener('canplaythrough', () => {
                        clearTimeout(timeoutId);
                    });
                    
                    audio.addEventListener('ended', () => {
                        clearTimeout(timeoutId);
                        this.currentAudio = null;
                        resolve(true);
                    });
                    
                    audio.addEventListener('error', (error) => {
                        clearTimeout(timeoutId);
                        console.error('音频播放错误:', error, 'URL:', audioUrl);
                        this.currentAudio = null;
                        this.statusText.textContent = `${word} 音频加载失败，尝试其他方式`;
                        resolve(false);
                    });
                    
                    this.currentAudio = audio;
                    
                    // 开始播放
                    const playPromise = audio.play();
                    if (playPromise !== undefined) {
                        playPromise.catch(error => {
                            clearTimeout(timeoutId);
                            console.error('音频播放失败:', error, 'URL:', audioUrl);
                            this.currentAudio = null;
                            this.statusText.textContent = `${word} 音频播放失败，尝试其他方式`;
                            resolve(false);
                        });
                    }
                });
            }
            
            // 播放当前单词
            playCurrentWord() {
                if (this.currentIndex >= this.words.length) return;
                
                const wordData = this.words[this.currentIndex];
                
                if (this.pronunciation === 'both') {
                    // 播放英音
                    if (wordData.ukAudio) {
                        this.playAudio(wordData.ukAudio, 'uk').then((success) => {
                            if (success && wordData.usAudio) {
                                setTimeout(() => this.playAudio(wordData.usAudio, 'us'), this.intervalTime * 1000);
                            }
                        });
                        return;
                    } else if (wordData.usAudio) {
                        // 如果没有英音但有美音，只播放美音
                        this.playAudio(wordData.usAudio, 'us');
                        return;
                    }
                } else {
                    let audioUrl = null;
                    if (this.pronunciation === 'uk') {
                        audioUrl = wordData.ukAudio || wordData.usAudio;
                    } else if (this.pronunciation === 'us') {
                        audioUrl = wordData.usAudio || wordData.ukAudio;
                    }
                    
                    if (audioUrl) {
                        const pronunciationType = audioUrl === wordData.ukAudio ? 'uk' : 'us';
                        this.playAudio(audioUrl, pronunciationType);
                    }
                }
            }
            
            // 播放特定发音
            playPronunciation(pronunciation) {
                if (this.currentIndex >= this.words.length) return;
                
                const wordData = this.words[this.currentIndex];
                let audioUrl = null;
                
                if (pronunciation === 'uk') {
                    audioUrl = wordData.ukAudio || wordData.usAudio;
                } else if (pronunciation === 'us') {
                    audioUrl = wordData.usAudio || wordData.ukAudio;
                }
                
                if (audioUrl) {
                    this.playAudio(audioUrl, pronunciation);
                } else {
                    this.statusText.textContent = `${wordData.word} 没有可用音频`;
                }
            }
            
            // 切换暂停状态
            togglePause() {
                if (!this.isPlaying) return;
                
                this.isPaused = !this.isPaused;
                
                if (this.isPaused) {
                    if (this.currentAudio) {
                        this.currentAudio.pause();
                    }
                    // 停止TTS
                    if ('speechSynthesis' in window) {
                        speechSynthesis.pause();
                    }
                    this.updateStatus('paused', '已暂停');
                    this.pauseBtn.innerHTML = '<i class="fas fa-play"></i> 继续';
                } else {
                    if (this.currentAudio) {
                        this.currentAudio.play();
                    }
                    // 继续TTS
                    if ('speechSynthesis' in window) {
                        speechSynthesis.resume();
                    }
                    this.updateStatus('playing', '正在播放...');
                    this.pauseBtn.innerHTML = '<i class="fas fa-pause"></i> 暂停';
                }
            }
            
            // 停止播放
            stopPlayback() {
                this.isPlaying = false;
                this.isPaused = false;
                
                if (this.currentAudio) {
                    this.currentAudio.pause();
                    this.currentAudio = null;
                }
                
                // 停止TTS
                if ('speechSynthesis' in window) {
                    speechSynthesis.cancel();
                }
                
                this.currentIndex = 0;
                this.updateCurrentWordDisplay();
                this.updatePlaybackControls();
                this.updateStatus('ready', '已停止');
                this.progressText.textContent = '';
            }
            
            // 更新播放控制按钮状态
            updatePlaybackControls() {
                if (this.isPlaying) {
                    this.playBtn.disabled = true;
                    this.pauseBtn.disabled = false;
                    this.stopBtn.disabled = false;
                } else {
                    this.playBtn.disabled = false;
                    this.pauseBtn.disabled = true;
                    this.stopBtn.disabled = true;
                    this.pauseBtn.innerHTML = '<i class="fas fa-pause"></i> 暂停';
                }
            }
            
            // 启用播放控制
            enablePlaybackControls() {
                this.playBtn.disabled = false;
            }
            
            // 禁用播放控制
            disablePlaybackControls() {
                this.playBtn.disabled = true;
                this.pauseBtn.disabled = true;
                this.stopBtn.disabled = true;
            }
            
            // 更新状态指示器
            updateStatus(status, message) {
                this.statusIndicator.className = 'status-dot';
                
                switch (status) {
                    case 'ready':
                        this.statusIndicator.classList.add('status-ready');
                        break;
                    case 'loading':
                        this.statusIndicator.classList.add('status-ready');
                        break;
                    case 'playing':
                        this.statusIndicator.classList.add('status-playing');
                        break;
                    case 'paused':
                        this.statusIndicator.classList.add('status-ready');
                        break;
                    case 'error':
                        this.statusIndicator.style.backgroundColor = '#ef4444';
                        break;
                }
                
                this.statusText.textContent = message;
            }
            
            // 辅助函数：休眠
            sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
        }

        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', () => {
            createStars();
            const player = new WordPlayer();
            
            // 将播放器实例附加到window对象以便调试
            window.wordPlayer = player;
            
            // 显示欢迎信息
            console.log('星际单词播放器已加载！');
        });
    </script>
</body>
</html>